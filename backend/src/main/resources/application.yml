spring:
  application:
    name: wink-ai-previz
  web:
    resources:
      add-mappings: false  # Отключаем обработку статических ресурсов Spring Boot
  servlet:
    multipart:
      max-file-size: 50MB
      max-request-size: 50MB
  jpa:
    properties:
      hibernate:
        jdbc:
          time_zone: UTC
    hibernate:
      ddl-auto: validate
    open-in-view: false
    show-sql: false
  flyway:
    enabled: true
  threads:
    virtual:
      enabled: true

springdoc:
  override-with-generic-response: false
  swagger-ui:
    path: /api/v1/swagger-ui.html

app:
  storage:
    upload-dir: ${APP_STORAGE_UPLOAD_DIR:/data/uploads}
  workflows:
    dir: ${APP_WORKFLOWS_DIR:../ai-modules/workflows}
  parser:
    threshold: 3
    use-stub: false
    max-chars-per-chunk: 4000
    max-chunks: 100
  cors:
    allowed-origins: ${CORS_ALLOWED_ORIGINS:http://localhost:5173,http://localhost:3000}
  rate-limit:
    per-minute: ${APP_RATE_LIMIT_PER_MINUTE:5}
  scene-parser:
    # In‑memory queue capacity for scene parsing tasks (to protect memory under large scripts).
    queue-capacity: ${SCENE_PARSER_QUEUE_CAPACITY:256}
    # Number of worker threads polling the queue and calling Ollama (limits parallel LLM calls).
    worker-threads: ${SCENE_PARSER_WORKERS:4}

ai:
  generate:
    base-url: ${AI_GENERATE_BASE_URL:http://ai:8000}
script-processor:
  base-url: ${SCRIPT_PROCESSOR_BASE_URL:http://script-processor:8020}
  model: ${SCRIPT_PROCESSOR_MODEL:Qwen/Qwen3-32B}

ollama:
  base-url: ${OLLAMA_BASE_URL:http://host.docker.internal:11434}
  api-key: ${OLLAMA_API_KEY:}
  # Default model for all Ollama-based scene parsing and prompt-building.
  # For this project we target a single small model instance used via /api/generate.
  model: ${OLLAMA_MODEL:qwen3:4b-instruct}
  # Basic HTTP timeouts (ms) to avoid hanging requests.
  connect-timeout-ms: ${OLLAMA_CONNECT_TIMEOUT_MS:5000}
  read-timeout-ms: ${OLLAMA_READ_TIMEOUT_MS:120000}

management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: always


